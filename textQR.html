<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Text Logger</title>
</head>
<body>

    <label for="qrInput">QR:</label>
    <input type="text" id="qrInput" name="QR" placeholder="Enter text">

    <button onclick="logQRText()">GÃ–NDER</button>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.988.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js/dist/amazon-cognito-identity.min.js"></script>

    <script>
        var accesKey ="";
        var qrText = "";
        

        function logQRText() {
            // Get the value from the input field
            qrText = document.getElementById("qrInput").value;
            getKey();
            // Log the value to the console
            console.log("QR Text: " + qrText);            
        }



        function getKey(){  
            const url = 'https://ofr5pa7gv3.execute-api.eu-central-1.amazonaws.com/get/get_key'
            fetch(url)
              .then(response => response.json())
              .then(data => {
                accesKey = data["key"];
                console.log("key: "     + accesKey);
                callQR(qrText);
                
              })
              .catch(error => console.error(error));
          }

          function callQR(qr){  
            const apiEndpoint = 'https://dv42w4b7l8.execute-api.eu-central-1.amazonaws.com/turnOn/turn_on'
            const url = `${apiEndpoint}?qr=${qr}&key=${accesKey}`;
            console.log(url);
            fetch(url)
              .then(response => response.json())
              .then(data => {
                
                console.log(data);
                var message= data["status"] + "\n"  + data["name"] + "\n" + data["company"] + "\n" + data["store"] + "\n" + data["duration"] + " saniye"
                alert(message)
                
              })
              .catch(error => console.error(error));
          }
    </script>

</body>
</html>







